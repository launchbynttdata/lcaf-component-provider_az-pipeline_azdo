# This template will validate the branch name meets our requirements for automated versioning.
# The following variables must be present in the current scope for this job to run:
#  agentPool: The name of the ADO Agent pool to run the job on.
#  serviceConnection: The name of the Service Connection to utilize
#  buildSourceBranch: The branch of the triggering repo the build was queued for.
#  pullRequestSourceBranch: The name of the source branch for a pull request.
#  pullRequestTargetBranch: The name of the target branch for a pull request.

stages:
  - stage: BranchNameValidation
    displayName: Branch Name Validation
    condition: "eq(variables['System.PullRequest.TargetBranch'], 'refs/heads/main')"
    jobs:
      - template: /common/jobs/generic-job.yaml
        parameters:
          jobName: PlatformValidation
          jobDisplayName: Platform Validation
          poolName: $(agentPool)
          steps:
            - template: /common/steps/has_semver_tag.yaml
              parameters:
                serviceConnection: $(serviceConnection)
            - template: /common/steps/launch_validate_branch_name.yaml

