parameters:
  - name: subscriptionId
    type: string
  - name: repositoryUrl
    type: string
    default: ''
  - name: gitToken
    type: string
    default: ''
  - name: commitSha
    type: string
    default: ''
  - name: targetEnvironment
    type: string
    default: ''

steps:
  - task: AzureClI@2
    displayName: Run Launch Pipeline Terragrunt Plan
    inputs:
      scriptType: bash
      scriptLocation: inlineScript
      workingDirectory: $(System.DefaultWorkingDirectory)
      inlineScript: |
        set -ex
        python3 -m pip install launch-cli
        echo "dryrun: launch pipeline terragrunt plan"
        # launch pipeline terragrunt plan \
        #   --repository-url  ${{ parameters.repositoryUrl }}\
        #   --git-token ${{ parameters.gitToken }}\
        #   --commit-sha ${{ parameters.commitSha }}\
        #   --target-environment ${{ parameters.targetEnvironment }}
      azureSubscription: ${{ parameters.subscriptionId }}
      addSpnToEnvironment: true
